const boardXSize=15,boardYSize=19;let board=[],currentPlayer="X",selectedCell=null;const tilte=document.querySelector(".tilte"),namepage=document.querySelector(".tilte .name"),turn=document.querySelector(".button .turn");function refresh(){currentPlayer="X",namepage.innerText="CARO.Z",turn.innerText=`Lượt của: ${currentPlayer}`,initializeBoard(),renderBoard()}turn.innerText=`Lượt của: ${currentPlayer}`,tilte.addEventListener("click",(function(){location.reload()}));const refreshbtn=document.querySelector(".refresh");function initializeBoard(){for(let e=0;e<boardYSize;e++){board[e]=[];for(let t=0;t<boardXSize;t++)board[e][t]=""}}function renderBoard(){const e=document.querySelector(".game-board");e.innerHTML="";const t=new Audio;t.src="./sounds/click.mp3";for(let r=0;r<boardYSize;r++)for(let n=0;n<boardXSize;n++){const o=document.createElement("div");o.classList.add("cell"),o.dataset.row=r,o.dataset.col=n,o.innerText=board[r][n],o.addEventListener("click",(function(){t.play(),handleCellClick(parseInt(o.dataset.row),parseInt(o.dataset.col))})),e.appendChild(o)}}function isValidMove(e,t){return""===board[e][t]}function handleCellClick(e,t){const r=document.querySelector(`.cell[data-row="${e}"][data-col="${t}"]`);null===selectedCell?(selectedCell=r,r.classList.add("seeing")):(selectedCell.classList.remove("seeing"),selectedCell!==r?(selectedCell=r,r.classList.add("seeing")):(makeMove(e,t),selectedCell=null,r.classList.remove("seeing")))}function makeMove(e,t){const r=document.querySelector(`.cell[data-row="${e}"][data-col="${t}"]`);if(isValidMove(e,t)){if(document.querySelectorAll(".cell.moved").forEach((e=>{e.classList.remove("moved")})),board[e][t]=currentPlayer,r.innerHTML="X"===currentPlayer?'<img src="./images/black.svg" width="22px" alt="X" />':'<img src="./images/white.svg" width="24px" alt="O" />',r.classList.add("moved"),checkWinner(e,t,currentPlayer))return;currentPlayer="X"===currentPlayer?"O":"X",turn.innerText=`Lượt của: ${currentPlayer}`}}function announceWinner(e){const t=e+" - wins!";namepage.innerText=t;const r=document.createElement("div"),n=document.createElement("div");r.classList.add("overlay"),n.classList.add("box"),n.innerHTML='\n        <span class="box__title">Trận đấu đã kết thúc</span>\n        <div class="box__button">\n            <span onclick="endtostart()" >▶ CARO.Z ◀</span>\n            \x3c!-- <span>Tiếp trận nữa!</span> --\x3e\n        </div>',document.body.appendChild(r),document.body.appendChild(n)}function endtostart(){const e=document.querySelector(".overlay"),t=document.querySelector(".box");e&&t&&(e.remove(),t.remove()),refresh()}function checkWinner(e,t,r){const n=getHorizontal(e,t,r),o=getVertical(e,t,r),a=getRightDiagonal(e,t,r),l=getLeftDiagonal(e,t,r),c=n>=5||o>=5||a>=5||l>=5;return c&&announceWinner(r),c}function getHorizontal(e,t,r){let n=1;for(let o=t+1;o<boardXSize&&""!==board[e][o]&&board[e][o]===r;o++)n++;const o=t-1;for(let t=0;t<=o&&board[e][o-t]===r;t++)n++;return n}function getVertical(e,t,r){let n=1;for(let o=e+1;o<boardYSize&&""!==board[o][t]&&board[o][t]===r;o++)n++;const o=e-1;for(let e=0;e<=o&&board[o-e][t]===r;e++)n++;return n}function getRightDiagonal(e,t,r){let n=1,o=e+1,a=t+1;for(;o<boardYSize&&a<boardXSize&&""!==board[o][a]&&board[o][a]===r;)n++,o++,a++;for(o=e-1,a=t-1;o>=0&&a>=0&&""!==board[o][a]&&board[o][a]===r;)n++,o--,a--;return n}function getLeftDiagonal(e,t,r){let n=1,o=e+1,a=t-1;for(;o<boardYSize&&a>=0&&""!==board[o][a]&&board[o][a]===r;)n++,o++,a--;for(o=e-1,a=t+1;o>=0&&a<boardXSize&&""!==board[o][a]&&board[o][a]===r;)n++,o--,a++;return n}refreshbtn.addEventListener("click",refresh),initializeBoard(),renderBoard();